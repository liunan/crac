<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <title>编码</title>
  <base href="/crac/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">

<script>
  
</script>

</head>
<body>
    <input type="text" id="address"/>
    <input type="button" value="查询" />

    <script>
        function index2Char(idx)
        {
            return String.fromCharCode( 'A'.charCodeAt(0)+idx);
        }

        function getCode(lon,lat){
            let lon_in_s = (lon+180)*60;
            let lat_in_s = (lat+90)*60;

            let field1 = Math.floor(lon_in_s/1200);
            let field2 = Math.floor(lat_in_s/600);
            console.log(`${field1}-${field2}`);
            let Field = index2Char(field1)+index2Char(field2);
            console.log(Field);

            let square1 = Math.floor(Math.floor(lon+180)%20/2);
            let square2 = Math.floor(lat+90)%10;
            let code = Field + square1+square2;

            console.log(code);

        }

        getCode(120.0001,39.9);

        let baiduAK = 'hnmDylimwUfK48d3CDuPuqZEm05U8bmA';
        const url='https://api.map.baidu.com/geocoder/v2/?address=%E5%8C%97%E4%BA%AC%E5%B8%82%E6%B5%B7%E6%B7%80%E5%8C%BA%E4%B8%8A%E5%9C%B0%E5%8D%81%E8%A1%9710%E5%8F%B7&output=json&ak='+baiduAK;
        fetch(url,
            {mode: "cors"
        }).then((res)=>{
            console.log(res);
        })
    </script>
</body>
</html>
